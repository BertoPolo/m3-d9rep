<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TroncoMovil-product</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">
    <style>
        body{
            background: rgb(77, 97, 116);
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="#">TroncoMovil</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
      
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav mr-auto">
            <li class="nav-item active">
                <a class="nav-link" href="./mainPage.html">Home <span class="sr-only">(current)</span></a>

            </li>
            <li class="nav-item">
              <a class="nav-link" href="./backOffice.html">Back Office</a>
            </li>
            
        </div>
      </nav>

      <div class="container" id="container"></div>



    <script>

        const params = new URLSearchParams(window.location.search)
        const id = params.get("id")
        const container = document.getElementById("container")
        
        
        const getTheProduct = async()=>{
            try {
                const response = await fetch("https://striveschool-api.herokuapp.com/api/product/"+id,
                
                {headers: {
                "Authorization": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MjA1MTBjOWRhNDBjOTAwMTVmYzhkNmEiLCJpYXQiOjE2NDY4MzA4ODUsImV4cCI6MTY0ODA0MDQ4NX0.neLRXyKa5PRoPDvmTjfltkJkFoj16fZL7ZiL3XAM5yw"
                ,'Content-Type': 'application/json'
                },}) 
                const data = await response.json()

                if (response.ok) {
                    
                    console.log(data)
                    
                    container.innerHTML=`
                    <div class="card mt-4 mx-auto" style="width: 30rem;">
                                <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRel-4YeqVOjBCKBUWSn65HwXhU6F5KYcWnGw&usqp=CAU" class="card-img-top" alt="...">
                                <div class="card-body">
                                    <h5 class="card-title">${data.name}</h5>
                                    <h5 class="card-title">${data.brand}</h5>
                                    <p class="card-text">${data.price}â‚¬</p>
                                    <p class="card-text">${data.description}</p>
                                    <a href="" class="btn btn-primary onclick="toEdit()">Edit</a>
                                    <a href="" class="btn btn-danger" onclick="toDelete()">Delete</a>
                                </div>
                             </div>
                    `

                } else {
                    alert("Something went wrong, looser")
                }


        }catch(e){
            console.log(e)
        }
    }

        getTheProduct()


        const toEdit=async ()=>{
// change the content for like backoffice (filled)
            try {
                const response= fetch("https://striveschool-api.herokuapp.com/api/product/" +id,{
                    headers: {
                "Authorization": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MjA1MTBjOWRhNDBjOTAwMTVmYzhkNmEiLCJpYXQiOjE2NDY4MzA4ODUsImV4cCI6MTY0ODA0MDQ4NX0.neLRXyKa5PRoPDvmTjfltkJkFoj16fZL7ZiL3XAM5yw"         
                },
                method:"PUT"
                })
                
            } catch (e) {
                console.log(e)
            }

        }

        const toDelete = async ()=>{

            try {
                const response= fetch("https://striveschool-api.herokuapp.com/api/product/" +id,{
                    headers: {
                "Authorization": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MjA1MTBjOWRhNDBjOTAwMTVmYzhkNmEiLCJpYXQiOjE2NDY4MzA4ODUsImV4cCI6MTY0ODA0MDQ4NX0.neLRXyKa5PRoPDvmTjfltkJkFoj16fZL7ZiL3XAM5yw"         
                },
                method: "DELETE"
                }) 

            } catch (e) {
                console.log(e)
            }
        }

    </script>
</body>
</html>